"use strict";(()=>{var d="1.0.0",t="XN9H16FK5J2LQYg5KVLq",r=class extends HTMLElement{constructor(){super(),this.scene=null,this.containerEl=null,this._resizeHandler=null,this._resizeTimeout=null,this._resizeObserver=null}connectedCallback(){console.log(`[UnicornStudio] Version ${d} - Initializing...`),this.setupDOM(),this.initializeUnicornStudio(),window.ResizeObserver&&(this._resizeObserver=new ResizeObserver(i=>{this._resizeTimeout&&clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout(()=>{this.updateSize()},100)}),this._resizeObserver.observe(this)),window.addEventListener("resize",this._resizeHandler=()=>{this._resizeTimeout&&clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout(()=>{this.updateSize()},100)})}disconnectedCallback(){console.log("[UnicornStudio] Disconnected - cleaning up..."),this.scene&&typeof this.scene.destroy=="function"&&(this.scene.destroy(),this.scene=null),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null),this._resizeHandler&&(window.removeEventListener("resize",this._resizeHandler),this._resizeHandler=null),this._resizeTimeout&&(clearTimeout(this._resizeTimeout),this._resizeTimeout=null)}setupDOM(){this.style.display="block",this.style.width="100%",this.style.minHeight="400px",this.style.height="100%",this.style.position="relative",this.style.overflow="hidden",this.style.boxSizing="border-box";let i=document.createElement("div");i.className="unicorn-studio-page",i.innerHTML=`
      <style>
        :host {
          display: block;
          width: 100%;
          min-height: 400px;
          height: 100%;
          position: relative;
          box-sizing: border-box;
          overflow: hidden;
        }
        
        .unicorn-studio-page {
          width: 100%;
          height: 100%;
          min-height: 400px;
          position: relative;
          box-sizing: border-box;
          overflow: hidden;
        }

        .unicorn-embed {
          width: 100%;
          height: 100%;
          position: relative;
        }
      </style>
      <div class="unicorn-embed"></div>
    `,this.appendChild(i),this.containerEl=i.querySelector(".unicorn-embed")}loadUnicornStudioScript(){return new Promise((i,n)=>{if(window.UnicornStudio){console.log("[UnicornStudio] Script already loaded, window.UnicornStudio exists"),console.log("[UnicornStudio] window.UnicornStudio:",window.UnicornStudio),i();return}let o=document.querySelector('script[src*="unicornstudio.js"]');if(o)console.log("[UnicornStudio] Existing script found, waiting for load..."),window.UnicornStudio?(console.log("[UnicornStudio] UnicornStudio already available from existing script"),i()):(o.addEventListener("load",()=>{console.log("[UnicornStudio] Existing script loaded"),i()}),o.addEventListener("error",e=>{console.error("[UnicornStudio] Existing script error:",e),n(e)}));else{console.log("[UnicornStudio] Creating new script element...");let e=document.createElement("script");e.src="https://cdn.jsdelivr.net/gh/hiunicornstudio/unicornstudio.js@v2.0.2/dist/unicornStudio.umd.js",e.async=!0,e.onload=()=>{console.log("[UnicornStudio] Script onload fired"),console.log("[UnicornStudio] window.UnicornStudio after load:",window.UnicornStudio),console.log("[UnicornStudio] typeof window.UnicornStudio:",typeof window.UnicornStudio),setTimeout(()=>{console.log("[UnicornStudio] After timeout - window.UnicornStudio:",window.UnicornStudio),i()},100)},e.onerror=s=>{console.error("[UnicornStudio] Script onerror fired:",s),n(new Error("Failed to load Unicorn Studio script"))},document.head?(console.log("[UnicornStudio] Appending script to head"),document.head.appendChild(e)):(console.log("[UnicornStudio] Head not available, waiting for DOMContentLoaded"),document.addEventListener("DOMContentLoaded",()=>{console.log("[UnicornStudio] DOMContentLoaded fired, appending script"),document.head.appendChild(e)}))}})}initializeUnicornStudio(){console.log(`[UnicornStudio] Loading scene with Project ID: ${t}`),this.loadUnicornStudioScript().then(()=>{if(console.log("[UnicornStudio] Script load promise resolved"),console.log("[UnicornStudio] window.UnicornStudio:",window.UnicornStudio),console.log("[UnicornStudio] typeof window.UnicornStudio:",typeof window.UnicornStudio),!window.UnicornStudio)throw console.error("[UnicornStudio] UnicornStudio is not available after script load"),new Error("UnicornStudio is not available");console.log("[UnicornStudio] Available methods:",{init:typeof window.UnicornStudio.init,addScene:typeof window.UnicornStudio.addScene,isInitialized:window.UnicornStudio.isInitialized}),console.log("[UnicornStudio] Setting up scene with data-attributes method"),this.containerEl.setAttribute("data-us-project",t),this.containerEl.setAttribute("data-us-scale","1"),this.containerEl.setAttribute("data-us-dpi","1.5"),this.containerEl.setAttribute("data-us-production","true"),this.containerEl.setAttribute("data-us-alttext","Unicorn Studio Scene"),this.containerEl.setAttribute("data-us-arialabel","This is a canvas scene"),console.log("[UnicornStudio] Container element:",this.containerEl),console.log("[UnicornStudio] Container attributes:",{"data-us-project":this.containerEl.getAttribute("data-us-project"),"data-us-scale":this.containerEl.getAttribute("data-us-scale"),"data-us-dpi":this.containerEl.getAttribute("data-us-dpi")}),window.UnicornStudio.isInitialized?(console.log("[UnicornStudio] Already initialized, calling updateSize"),this.updateSize()):(console.log("[UnicornStudio] Calling UnicornStudio.init()..."),typeof window.UnicornStudio.init=="function"?window.UnicornStudio.init().then(()=>{console.log("[UnicornStudio] Init completed successfully"),window.UnicornStudio.isInitialized=!0,this.updateSize(),setTimeout(()=>{console.log("[UnicornStudio] Scene check after 1s - container children:",this.containerEl.children.length),console.log("[UnicornStudio] Container innerHTML length:",this.containerEl.innerHTML.length)},1e3)}).catch(i=>{console.error("[UnicornStudio] Init error:",i)}):(console.error("[UnicornStudio] UnicornStudio.init is not a function"),console.log("[UnicornStudio] Trying to use addScene if available..."),typeof window.UnicornStudio.addScene=="function"?(console.log("[UnicornStudio] Using addScene method..."),window.UnicornStudio.addScene({element:this.containerEl,projectId:t,dpi:1.5,scale:1,lazyLoad:!1,altText:"Unicorn Studio Scene",ariaLabel:"This is a canvas scene"}).then(i=>{console.log("[UnicornStudio] Scene loaded successfully via addScene",i),this.scene=i,this.updateSize()}).catch(i=>{console.error("[UnicornStudio] Error loading scene via addScene:",i)})):console.error("[UnicornStudio] Neither init nor addScene is available")))}).catch(i=>{console.error("[UnicornStudio] Error initializing:",i),console.error("[UnicornStudio] Error stack:",i.stack)})}updateSize(){if(!this.containerEl)return;let i=this.getBoundingClientRect(),n=Math.max(i.width||this.clientWidth||this.offsetWidth||0,0),o=Math.max(i.height||this.clientHeight||this.offsetHeight||0,0);if(n===0||o===0){setTimeout(()=>this.updateSize(),50);return}this.containerEl.style.width=`${n}px`,this.containerEl.style.height=`${o}px`,this.scene&&typeof this.scene.resize=="function"&&this.scene.resize(n,o)}};customElements.get("unicorn-studio-embed")?console.warn("[UnicornStudio] Custom element already registered"):(customElements.define("unicorn-studio-embed",r),console.log("[UnicornStudio] Custom element registered: unicorn-studio-embed"));})();
